{% load i18n %}

<script>

    $(document).ready(function () {
        // Load current overlay data
        $.getJSON("/api/overlay/overlay_style/{{ user.id }}", function (data) {
            let current_style = data['start_style'];
            let selected_elem = $(`[data-value="${current_style}"]`);
            selected_elem.removeClass("btn-outline-success");
            selected_elem.addClass("btn-success");

            $('#start-screenshot').attr("src", `/static/img/screenshots/start-${current_style}.png`);
        });

    });

    function setStartStyle(elem) {
        elem = $(elem);
        let all_elements = $('[data-style="start"]');

        for (let i = 0; i < all_elements.length; i++) {
            let tmp_elem = $(all_elements[i])
            if (tmp_elem !== elem) {
                tmp_elem.removeClass("btn-success");
                tmp_elem.addClass("btn-outline-success");
                tmp_elem.attr("data-active", "false");
            }
        }

        elem.removeClass("btn-outline-success");
        elem.addClass("btn-success");
        elem.attr("data-active", "true");

        let new_theme = elem.attr("data-value");
        $('#start-screenshot').attr("src", `/static/img/screenshots/start-${new_theme}.png`);

        let post_url = "/api/overlay/overlay_style/{{ user.id }}";
        let data = `{"start_style": "${new_theme}"}`;

        console.log("POST: " + post_url + " => " + data);

        $.post(post_url, data);

    }

</script>